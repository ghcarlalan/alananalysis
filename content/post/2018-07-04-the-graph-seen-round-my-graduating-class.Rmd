---
title: The Graph Seen 'Round My Graduating Class
author: Alan Carlson
date: '2018-07-04'
slug: the-graph-seen-round-my-graduating-class
categories: []
tags: []
---

```{r setup, include=FALSE}
library(dplyr)
library(knitr)
library(ggplot2)
library(lubridate)
library(reshape2)
library(blogdown)
library(htmltools)

theme_set(theme_bw() + theme(text = element_text(size=12)))

knit_hooks$set(htmlcap = function(before, options, envir) {
  if(!before) {
    paste('<p style="text-align:center "><i>',options$htmlcap,"</i></p>",sep="")
    }
    })
```

It's been 5 years since I graduated high school. There were about 1,200 students in total when I left, and I graduated with 286 other young adults eager to do something with our lives. If facebook is any indicator, that *something* was to get married and/or have kids as soon as possible. It's eastern Idaho; what can you expect?

```{r image,echo=FALSE,out.width='50%',htmlcap="So many Mormons is what you can expect",fig.align='center'}
knitr::include_graphics("/post/2018-07-04-the-graph-seen-round-my-graduating-class_files/0001people.jpeg")
```

Naturally, this can kind of (read: really) bum you out if you think you're in the minority of not being one of those people who have found their life partner or have had their mini me at 23 or younger. To combat this feeling, [this tweet](https://twitter.com/KeelyeShaye/status/1001511141711974400) was shared in my group chat with my 3 best friends from high school. Jokes about getting shitfaced aside, I was actually curious to find out just how many people I graduated with that I would be taking shots for (and if you're a part of HHS Class of 2013, prepare for several bottles of alcohol).


```{r,echo=FALSE,warning=FALSE,message=FALSE,fig.height=3}
#data load
dt <- read.csv("C://Users/Alan/OneDrive/Documents/OneDrive/hhs.csv",stringsAsFactors = FALSE)
names(dt) <- c("name","pregnant","engaged","shots","gender")

#convert gender to label
dt$gender <- ifelse(dt$gender == 1, "female","male")

#aggregate set
agg <- melt(dt[,c(1:3)],id="name")

agg <- agg %>%
  group_by(variable,value) %>%
  summarise(n = n()) %>%
  mutate(percent = n/sum(n))

#plot
ggplot(agg,aes(variable,percent,fill=as.character(value))) + 
  geom_bar(stat = 'identity',position = 'stack',color="white",size=.25) +
  geom_text(aes(label = paste(round(agg$percent,3)*100,"%",sep = '')),
            position = position_stack(vjust=.5),
            fontface = "bold",
            color="white") +
  coord_flip(ylim = c(0,1)) +
  scale_x_discrete(labels = c("At least\nPregnant","At least\nEngaged")) +
  scale_y_continuous(expand = c(0,0)) +
  scale_fill_manual('',labels=c("No","Yes"),values = c("black","#D90B0B")) +
  labs(x=NULL,
       y=NULL,
       title="Percent of Class by Status",
       subtitle = paste("(Out of",nrow(dt),"total students)"),
       caption = "Generated by Alan Carlson") +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(panel.grid = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        legend.position = c(.9,1.075),
        legend.background = element_blank(),
        legend.direction = 'horizontal',
        legend.text = element_text(face='bold'))
```

